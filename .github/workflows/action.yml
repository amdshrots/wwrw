name: macOS Setup

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: macos-latest
    timeout-minutes: 360  # Set the timeout to 6 hours (360 minutes)

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: Install jq
      run: brew install jq

    - name: Connect to PlayIt.gg
      env:
        PLAYIT_SECRET: ${{ secrets.PL }}
      run: |
        PLAYIT_IP=$(curl -s https://api.playit.gg/v1/tunnel -H "Authorization: Bearer $PLAYIT_SECRET" | jq -r '.ip')
        PLAYIT_PORT=$(curl -s https://api.playit.gg/v1/tunnel -H "Authorization: Bearer $PLAYIT_SECRET" | jq -r '.port')
        echo "IP: $PLAYIT_IP"
        echo "Port: $PLAYIT_PORT"
        
        # Keep the workflow running for 6 hours
        sleep 21600  # 6 hours in seconds
